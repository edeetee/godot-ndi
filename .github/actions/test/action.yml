name: Run GUT Tests

inputs:
  godot-url:
    require: true
  godot-bin:
    require: true

runs:
  using: composite
  steps:
    - name: Install Godot
      shell: bash
      run: |
        curl -s -S -L ${{ inputs.godot-url }} --output godot.zip
        unzip -q godot.zip
        chmod +x ${{ inputs.godot-bin }}

    - name: Print Folder Tree
      uses: jaywcjlove/github-action-folder-tree@main
      with:
        depth: 10
        path: ./project

    - name: Run GUT
      shell: bash
      run: ${{ inputs.godot-bin }} --headless -d -s --path ./project addons/gut/addons/gut/gut_cmdln.gd -gdir=res://test -ginclude_subdirs -gexit